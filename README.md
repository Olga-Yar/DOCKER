# Трекер полезных привычек

В 2018 году Джеймс Клир написал книгу «Атомные привычки», которая посвящена приобретению новых полезных привычек и искоренению старых плохих привычек.

---

## Структура проекта:
* Модель
* Валидаторы
* Пагинация
* Права доступа
* Эндпоинты
* Интеграция
* Безопасность
* Документация

---

## Запуск проекта

1. Для запуска проекта необходимо установить docker <br>
https://www.docker.com/ <br> <br>
2. Клонировать проект через терминал или IDE  <br>
https://github.com/Olga-Yar/DOCKER <br> <br>
3. Запустить процесс создания и запуска образа <br>
docker-compose up (build) <br> <br>
4. Документация проекта (swagger или redoc) <br>
http://127.0.0.1:8000/swagger/  <br>
http://127.0.0.1:8000/redoc/ <br> <br>
5. Открыть в браузере приложение <br>
http://127.0.0.1:8000/

---

### Модель Привычка. Habit
Описание полей:
* user - поле FK к модели Пользователи
* place - место выполнения привычки
* time_start - время старта выполнения привычки
* action - действие / привычка
* is_pleasure - флаг - является ли привычка приятной
* is_connect - ссылка модели на саму себя - является ли привычка связанной с другой привычкой
* periodic - периодичность выполнения привычки <br>
Выбор из списка PERIODIC_CHOICE: ежедневно или еженедельно


* days_period - день недели для выполнения привычки <br>
Выбор из списка DAYS_CHOICE: выбор дня недели


* reward - награда за выполнение привычки
* execution_time - время выполнения привычки
* is_public - является ли привычка публичной


### Модель Пользователь. UserCustom
Описание полей:
* email
* first_name
* last_name
* avatar
* phone
* chat_id (id телеграм)
* telegram
* role <br>

Все поля кроме email и role необязательные. <br>
#### Поле role - выбор роли для пользователя: moderator или member.

---

## Валидация

* Запрещен одновременный выбор связанной привычки и указания вознаграждения.<br>
Валидация на уровне модели <br>
``elif self.is_pleasure and self.reward is not None:``  <br>
``raise ValidationError()``


* Время выполнения должно быть не больше 120 секунд. <br>
``# validators.py`` <br>
``def validator_execution_time(value):``  <br>


* В связанные привычки могут попадать только привычки с признаком приятной привычки. <br>
Валидация на уровне модели <br>
``if not self.is_pleasure and self.is_connect:``  <br>
``raise ValidationError()``

* У приятной привычки не может быть вознаграждения или связанной привычки. <br>
Валидация на уровне модели <br>
``elif self.is_connect and self.reward is not None:``  <br>
``raise ValidationError()``


* Нельзя выполнять привычку реже, чем 1 раз в 7 дней. <br>
``# validators.py`` <br>
``def validator_periodicity(value):``  <br>



---

## Пагинация

Для вывода списка привычек реализована пагинацию с выводом по 5 привычек на страницу.

---

## Правда доступа

* Каждый пользователь имеет доступ только к своим привычкам по механизму CRUD.
* Пользователь может видеть список публичных привычек без возможности их как-то редактировать или удалять.

---

## Эндпоинты

* Регистрация
* Авторизация
* Список привычек текущего пользователя с пагинацией
* Список публичных привычек
* Создание привычки
* Редактирование привычки
* Удаление привычки

---

## Интеграция

Для полноценной работы сервиса реализована работа с отложенными
задачами для напоминания о том, в какое время какие привычки необходимо выполнять. <br>

Для этого интегрирован сервис с мессенджером Telegram, 
который будет заниматься рассылкой уведомлений.

---

## Безопасность

Для проекта настроен CORS, чтобы фронтенд мог подключаться к проекту на развернутом сервере.

Для работы приложения необходимо прописать в файле .env:
* DATABASES_HOST=
* DATABASES_PORT=
* DATABASES_USER=
* POSTGRES_PASSWORD=
* SECRET_KEY=
* CORS_ALLOWED_ORIGINS=
* TELEGRAM_API_TOKEN=

---

## Документация

Для реализации экранов силами фронтенд-разработчиков настроен вывод документации.
